/* REXX */
PARSE ARG DSN

ADDRESS ISPEXEC

/* ABRIR O DATASET */
"LMOPEN DATAID(DDID) DATASET("DSN") OPTION(INPUT)"
IF RC <> 0 THEN DO
   SAY "ERRO AO ABRIR DATASET: " RC
   EXIT RC
END

/* LOOP DE LISTAGEM */
DO FOREVER
   "LMMLIST DATAID("DDID") OPTION(LIST) MEMBER(MEM)"
   IF RC = 0 THEN DO
      SAY "MEMBRO: " MEM
      "LMMLIST DATAID("DDID") OPTION(FREE)"
   END
   ELSE IF RC = 4 THEN DO
      SAY "FIM DOS MEMBROS."
      LEAVE
   END
   ELSE DO
      SAY "ERRO LMMLIST RC=" RC
      LEAVE
   END
END

/* FECHAR DATASET */
"LMFREE DATAID("DDID")"
IF RC <> 0 THEN SAY "AVISO: LMFREE RC="RC
EXIT 0

